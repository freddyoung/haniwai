{% extends "base.html" %}
{% load wagtailcore_tags %}

{% block title %}Gallery - Haniwai NGO{% endblock %}

{% block content %}

<!-- ✅ Hero Section -->
<section class="gallery-hero">
    <div class="gallery-hero-overlay"></div>
    <div class="gallery-hero-content">
        <h1>Gallery</h1>
        {% if page.description %}
            <div class="gallery-description">
                {{ page.description|richtext }}
            </div>
        {% endif %}
    </div>
</section>

  


<section class="gallery-section">
    
    <form method="get" action="" class="search-form">
        <input type="text" name="q" placeholder="Search gallery images..." value="{{ request.GET.q }}">
        <button type="submit">Search</button>
      </form>
    <div class="gallery-container">


        {% for image in gallery_images %}
            <div class="gallery-item">
                <div class="image-wrapper">
                    <img src="{{ image.image.file.url }}"
                         alt="{{ image.image.title }}"
                         class="gallery-img"
                         data-index="{{ forloop.counter0 }}"
                         data-description="{{ image.image.description }}">
                    <div class="image-title-overlay">
                        {{ image.image.title }}
                    </div>
                </div>
            </div>
        {% empty %}
            <p style="text-align: center;">No images found.</p>
        {% endfor %}
    </div>

    

    {% if gallery_images.has_next %}
    <div class="see-more-container">
        <a href="?{% if query %}q={{ query }}&{% endif %}page={{ gallery_images.next_page_number }}" class="see-more-link">Load More →</a>
    </div>
    {% endif %}

    
</section>


    <!-- ✅ Lightbox -->
    <div id="lightbox" class="lightbox">
        <span class="close">&times;</span>
        <img id="lightbox-img" class="lightbox-img" src="" alt="">
        <div id="lightbox-description" class="lightbox-description"></div>
        <div class="lightbox-controls">
            <span class="prev">&lt;</span>
            <span id="image-counter" class="image-counter"></span>
            <span class="next">&gt;</span>
        </div>
    </div>
</section>


    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const galleryImages = document.querySelectorAll(".gallery-img");
            const lightbox = document.getElementById("lightbox");
            const lightboxImg = document.getElementById("lightbox-img");
            const lightboxDescription = document.getElementById("lightbox-description");
        
            galleryImages.forEach(img => {
                img.addEventListener("click", function () {
                    lightbox.style.display = "flex";
                    lightboxImg.src = this.src;
                    lightboxDescription.textContent = this.getAttribute("data-description");
                });
            });
        
            document.querySelector(".close").addEventListener("click", function () {
                lightbox.style.display = "none";
            });
        });
        
    </script>

    

{% endblock %}
